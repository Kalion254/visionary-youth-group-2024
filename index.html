<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Visionary Youth Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      display: flex;
      height: 100vh;
      overflow: hidden;
      background: #f4f7fa;
    }
    /* Sidebar */
    .sidebar {
      width: 250px;
      background: #006400;
      color: white;
      padding-top: 20px;
      position: fixed;
      height: 100%;
    }
    .sidebar h2 {
      text-align: center;
      margin-bottom: 20px;
      font-size: 1.5rem;
    }
    .sidebar a {
      display: block;
      color: white;
      padding: 12px 20px;
      text-decoration: none;
      font-weight: 600;
      transition: 0.3s;
    }
    .sidebar a:hover {
      background: #228b22;
    }
    /* Main content */
    .main {
      margin-left: 250px;
      padding: 20px;
      width: calc(100% - 250px);
      overflow-y: auto;
    }
    header {
      background: #fff;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    section {
      display: none;
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    section.active { display: block; }
    h2 { color: #006400; }
    input, select {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    button {
      padding: 10px 20px;
      background: #006400;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover { background: #228b22; }
    .progress {
      margin: 10px 0;
      height: 20px;
      background: #eee;
      border-radius: 6px;
      overflow: hidden;
    }
    .progress-bar {
      height: 100%;
      width: 40%;
      background: #ffcc00;
      text-align: center;
      line-height: 20px;
      font-size: 0.8rem;
      color: #333;
      transition: width 0.5s;
    }
  </style>
</head>
<body>

  <!-- Sidebar -->
  <div class="sidebar">
    <h2>üìä Dashboard</h2>
    <a href="#" onclick="showTab('overview')"><i class="fas fa-home"></i> Overview</a>
    <a href="#" onclick="showTab('loanApp')"><i class="fas fa-file-signature"></i> Loan Application</a>
    <a href="#" onclick="showTab('loanProgress')"><i class="fas fa-tasks"></i> Loan Progress</a>
    <a href="#" onclick="showTab('savings')"><i class="fas fa-piggy-bank"></i> Savings</a>
    <a href="#" onclick="showTab('shares')"><i class="fas fa-chart-line"></i> Shares</a>
    <a href="#" onclick="showTab('dividends')"><i class="fas fa-coins"></i> Dividends</a>
    <a href="#" onclick="showTab('profile')"><i class="fas fa-user-edit"></i> Profile Update</a>
    <a href="#" onclick="showTab('statement')"><i class="fas fa-file-download"></i> Account Statement</a>
    <a href="#" onclick="showTab('achievements')"><i class="fas fa-trophy"></i> Achievements</a>
    <a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</a>
  </div>

  <!-- Main content -->
  <div class="main">
    <header>
      <h1>Welcome to Visionary Youth</h1>
      <p id="userEmail"></p>
    </header>

    <!-- Overview -->
    <section id="overview" class="active">
      <h2>Overview</h2>
      <p>Track your financial journey with us.</p>
      <div class="progress"><div class="progress-bar" style="width:60%">Loans 60%</div></div>
      <div class="progress"><div class="progress-bar" style="width:80%">Savings 80%</div></div>
    </section>

    <!-- Loan Application -->
    <section id="loanApp">
      <h2>Loan Application</h2>
      <form id="loanForm">
        <h3>Personal Details</h3>
        <input type="text" id="loanName" placeholder="Full Name" required>
        <input type="text" id="loanPhone" placeholder="Phone Number" required>
        <input type="text" id="loanId" placeholder="ID Number" required>

        <h3>Residence</h3>
        <input type="text" id="loanOrigin" placeholder="Place of Residence" required>

        <h3>Loan Details</h3>
        <input type="number" id="loanAmount" placeholder="Loan Amount" required>
        <select id="loanCategory" required>
          <option value="">-- Select Loan Category --</option>
          <option>Business</option>
          <option>Education</option>
          <option>Emergency</option>
        </select>

        <h3>Guarantor</h3>
        <input type="text" id="guarantorName" placeholder="Guarantor Name" required>
        <input type="text" id="guarantorPhone" placeholder="Guarantor Phone" required>

        <button type="submit">Apply Loan</button>
      </form>
    </section>

    <!-- Loan Progress -->
    <section id="loanProgress">
      <h2>Loan Progress</h2>
      <p>Status: <strong id="loanStatus">Applied</strong></p>
      <ul>
        <li>üìå Registered - Pending</li>
        <li>üìå Verified - Pending</li>
        <li>üìå Allocated - Pending</li>
        <li>üìå Disbursement in Progress - Pending</li>
        <li>üìå Disbursed - Pending</li>
      </ul>
    </section>

    <!-- Savings -->
    <section id="savings">
      <h2>Savings</h2>
      <p>Weekly: 1050 KES</p>
      <p>Monthly: 4500 KES</p>
    </section>

    <!-- Shares -->
    <section id="shares">
      <h2>Shares</h2>
      <p>Current Shares: 400</p>
    </section>

    <!-- Dividends -->
    <section id="dividends">
      <h2>Dividends</h2>
      <p>Last Payout: KES 500</p>
    </section>

    <!-- Profile Update -->
    <section id="profile">
      <h2>Profile Update</h2>
      <form id="profileForm">
        <input type="text" id="profileName" placeholder="Full Name" required>
        <input type="text" id="profileId" placeholder="ID Number" required>
        <input type="email" id="profileEmail" placeholder="Email" required>
        <input type="text" id="profilePhone" placeholder="Phone Number" required>
        <input type="text" id="profileOrigin" placeholder="Place of Origin" required>
        <input type="text" id="profileMember" placeholder="Member Number" required>
        <input type="file" id="profilePassport" accept="image/*" required>
        <button type="submit">Update Profile</button>
      </form>
    </section>

    <!-- Account Statement -->
    <section id="statement">
      <h2>Account Statement</h2>
      <button onclick="downloadStatement()">Download PDF Statement</button>
    </section>

    <!-- Achievements -->
    <section id="achievements">
      <h2>Achievements</h2>
      <p>üéì Group Certificate Available</p>
      <p>üè¶ Bank Account Linked</p>
      <p>‚úÖ Official Stamp Registered</p>
      <button onclick="downloadAchievement()">Download Achievements</button>
    </section>
  </div>

  <!-- Firebase -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getAuth, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
    import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyA_OCu7HQ5HCH2OYx5dQ2Z1r7YPwQJave4",
      authDomain: "visionary-youth-grou-2024.firebaseapp.com",
      projectId: "visionary-youth-grou-2024",
      storageBucket: "visionary-youth-grou-2024.appspot.com",
      messagingSenderId: "372978592717",
      appId: "1:372978592717:web:1c15aec728ee5f854f3284",
      measurementId: "G-QP1RBT2ZCP"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // Show user email
    onAuthStateChanged(auth, user => {
      if (user) {
        document.getElementById("userEmail").innerText = user.email;
      } else {
        window.location.href = "index.html";
      }
    });

    // Logout
    function logout() {
      signOut(auth).then(() => window.location.href = "index.html");
    }
    window.logout = logout;

    // Switch tabs
    window.showTab = function(tabId) {
      document.querySelectorAll("section").forEach(s => s.classList.remove("active"));
      document.getElementById(tabId).classList.add("active");
    }

    // Loan Application
    document.getElementById("loanForm").addEventListener("submit", async e => {
      e.preventDefault();
      const user = auth.currentUser;
      if (!user) return;
      await setDoc(doc(db, "loans", user.uid), {
        name: document.getElementById("loanName").value,
        phone: document.getElementById("loanPhone").value,
        id: document.getElementById("loanId").value,
        origin: document.getElementById("loanOrigin").value,
        amount: document.getElementById("loanAmount").value,
        category: document.getElementById("loanCategory").value,
        guarantor: document.getElementById("guarantorName").value,
        guarantorPhone: document.getElementById("guarantorPhone").value,
        status: "Applied",
        date: new Date()
      });
      alert("Loan Application Submitted Successfully!");
      e.target.reset();
    });

    // Profile Update
    document.getElementById("profileForm").addEventListener("submit", async e => {
      e.preventDefault();
      const user = auth.currentUser;
      if (!user) return;
      await setDoc(doc(db, "profiles", user.uid), {
        name: document.getElementById("profileName").value,
        id: document.getElementById("profileId").value,
        email: document.getElementById("profileEmail").value,
        phone: document.getElementById("profilePhone").value,
        origin: document.getElementById("profileOrigin").value,
        member: document.getElementById("profileMember").value,
        passport: document.getElementById("profilePassport").value
      });
      alert("Profile Updated Successfully!");
    });

    // Auto logout after 3 minutes inactivity
    let timer;
    function resetTimer() {
      clearTimeout(timer);
      timer = setTimeout(() => logout(), 180000); // 3 mins
    }
    window.onload = resetTimer;
    document.onmousemove = resetTimer;
    document.onkeydown = resetTimer;

    // Download placeholders
    window.downloadStatement = () => alert("Statement download feature coming soon!");
    window.downloadAchievement = () => alert("Achievements download feature coming soon!");
  </script>
</body>
</html>
