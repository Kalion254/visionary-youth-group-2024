<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Visionary Youth Dashboard</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-storage-compat.js"></script>

<!-- FontAwesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
body{margin:0;font-family:'Segoe UI',sans-serif;background:#f5f7fa;}
header{background:#1976d2;color:white;padding:15px 30px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 5px 15px rgba(0,0,0,0.2);}
header h1{margin:0;font-size:22px;}
header .user-email{font-size:14px;opacity:0.85;}
header button{background:#ff5252;color:white;border:none;padding:8px 14px;border-radius:6px;cursor:pointer;transition:0.3s;}
header button:hover{background:#ff1744;}
footer{background:#1976d2;color:white;text-align:center;padding:12px;margin-top:20px;}
.container{padding:20px;}
.tabs{display:flex;gap:10px;margin-bottom:20px;flex-wrap:wrap;}
.tab-btn{flex:1;padding:10px;border:none;border-radius:8px;background:#e0e0e0;color:#333;font-weight:bold;cursor:pointer;transition:0.3s;}
.tab-btn.active{background:#1976d2;color:white;}
.card-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:20px;margin-bottom:20px;}
.card{background:linear-gradient(135deg,#2196f3,#21cbf3);color:white;padding:20px;border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,0.1);transition:0.3s;}
.card:hover{transform:translateY(-5px);box-shadow:0 12px 25px rgba(0,0,0,0.2);}
.card h3{display:flex;align-items:center;margin-top:0;font-size:18px;}
.card h3 i{margin-right:8px;}
.progress-bar{height:20px;background:#eee;border-radius:10px;overflow:hidden;margin-top:5px;}
.progress{height:100%;border-radius:10px;text-align:right;color:white;padding-right:5px;transition:width 1s;}
.section{display:none;background:white;padding:20px;border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,0.1);animation:fadeIn 0.6s;}
.section.active{display:block;}
@keyframes fadeIn{from{opacity:0;}to{opacity:1;}}
input,select,button{width:100%;padding:10px;margin:8px 0;border-radius:6px;border:1px solid #ccc;}
button{background:#1976d2;color:white;border:none;cursor:pointer;transition:0.3s;}
button:hover{background:#115293;}
table{width:100%;border-collapse:collapse;margin-top:10px;}
table th,table td{border:1px solid #ddd;padding:8px;text-align:center;}
table th{background:#1976d2;color:white;}
.badge{padding:3px 6px;border-radius:5px;color:white;font-weight:bold;}
.badge.Applied{background:#2196f3;}
.badge.Registered{background:#64b5f6;}
.badge.Verified{background:#ff9800;}
.badge.Allocation{background:#9c27b0;}
.badge['Disbursement in Progress']{background:#009688;}
.badge.Disbursed{background:#4caf50;}
</style>
</head>
<body>

<header>
<div>
<h1 id="userName">User</h1>
<div class="user-email" id="emailDisplay">email@example.com</div>
</div>
<button id="logoutBtn">Logout</button>
</header>

<div class="container">
<div class="tabs">
<button class="tab-btn active">Financial Overview</button>
<button class="tab-btn">Profile</button>
<button class="tab-btn">Loan Application</button>
<button class="tab-btn">Loan Progress</button>
<button class="tab-btn">Account Statement</button>
</div>

<div id="financial" class="section active">
<div class="card-grid">
<div class="card"><h3><i class="fa-solid fa-money-bill-wave"></i> Weekly Savings</h3><p id="weeklySavings">0</p><div class="progress-bar"><div class="progress" id="weeklyProgress">0%</div></div></div>
<div class="card"><h3><i class="fa-solid fa-calendar-days"></i> Monthly Savings</h3><p id="monthlySavings">0</p><div class="progress-bar"><div class="progress" id="monthlyProgress">0%</div></div></div>
<div class="card"><h3><i class="fa-solid fa-chart-simple"></i> Shares</h3><p id="shares">0</p><div class="progress-bar"><div class="progress" id="sharesProgress">0%</div></div></div>
<div class="card"><h3><i class="fa-solid fa-hand-holding-dollar"></i> Loan</h3><p id="loan">0</p><div class="progress-bar"><div class="progress" id="loanProgress">0%</div></div></div>
<div class="card"><h3><i class="fa-solid fa-circle-exclamation"></i> Unpaid Balances</h3><p id="unpaidBalances">0</p></div>
<div class="card"><h3><i class="fa-solid fa-gem"></i> Dividends</h3><p id="dividends">0</p></div>
</div>
</div>

<div id="profile" class="section">
<h3>Update Profile</h3>
<form id="profileForm">
<label>Name</label><input id="profileName" required>
<label>ID</label><input id="profileID" required>
<label>Email</label><input type="email" id="profileEmail" required>
<label>Phone Number</label><input id="profilePhone" required>
<label>Origin</label><input id="profileOrigin" required>
<label>Member Number</label><input id="profileMember" required>
<label>Passport Upload</label><input type="file" id="passport" accept="image/*" required>
<button type="submit" id="profileUpdateBtn">Update Profile</button>
</form>
</div>

<div id="loan" class="section">
<h3>Loan Application</h3>
<div id="loanProgressBar" class="progress-bar"><div id="loanProgressFill" class="progress" style="width:0%"></div></div>
<form id="loanMultiForm">
<!-- multi-step steps will go here -->
</form>
<button id="downloadLoanBtn" style="display:none;">Download Your Loan Application</button>
</div>

<div id="loanProgress" class="section">
<h3>Loan Progress History</h3>
<table id="loanProgressTable"><thead><tr><th>Date</th><th>Stage</th><th>Amount</th><th>Status</th></tr></thead><tbody></tbody></table>
</div>

<div id="statement" class="section">
<h3>Download Account Statement</h3>
<button id="downloadStatementBtn">Download CSV</button>
</div>

</div>
<footer>Visionary Youth Dashboard &copy; 2025</footer>

<script>
// Full modern dashboard JS
document.addEventListener("DOMContentLoaded", () => {
  const firebaseConfig = {
    apiKey: "AIzaSyA_OCu7HQ5HCH2OYx5dQ2Z1r7YPwQJave4",
    authDomain: "visionary-youth-grou-2024.firebaseapp.com",
    databaseURL: "https://visionary-youth-grou-2024-default-rtdb.firebaseio.com/",
    projectId: "visionary-youth-grou-2024",
    storageBucket: "visionary-youth-grou-2024.firebasestorage.app",
    messagingSenderId: "372978592717",
    appId: "1:372978592717:web:624596619d41aab84f3284",
    measurementId: "G-FEHC1GM3B7"
  };
  firebase.initializeApp(firebaseConfig);
  const auth=firebase.auth();
  const db=firebase.database();
  const storage=firebase.storage();
  let currentUserUid;

  // Tabs logic
  const tabButtons=document.querySelectorAll(".tab-btn");
  const sections=document.querySelectorAll(".section");
  function showSection(id,btn){
    sections.forEach(s=>s.classList.remove("active"));
    document.getElementById(id).classList.add("active");
    tabButtons.forEach(b=>b.classList.remove("active"));
    btn.classList.add("active");
  }
  tabButtons.forEach(btn=>{
    btn.addEventListener("click", ()=>{
      const t=btn.textContent.trim();
      switch(t){
        case "Financial Overview": showSection("financial",btn); break;
        case "Profile": showSection("profile",btn); break;
        case "Loan Application": showSection("loan",btn); break;
        case "Loan Progress": showSection("loanProgress",btn); break;
        case "Account Statement": showSection("statement",btn); break;
      }
    });
  });
  showSection("financial",tabButtons[0]);

  // Logout & auto-logout
  document.getElementById("logoutBtn").addEventListener("click",()=>auth.signOut().then(()=>window.location.href="index.html"));
  let inactivityTimer;
  function resetInactivity(){ clearTimeout(inactivityTimer); inactivityTimer=setTimeout(()=>{ alert("Logged out due to inactivity"); auth.signOut().then(()=>window.location.href="index.html"); },15*60*1000);}
  document.onmousemove=resetInactivity; document.onkeypress=resetInactivity;

  // Auth check
  auth.onAuthStateChanged(user=>{
    if(user){ currentUserUid=user.uid; loadProfile(); loadFinancials(); loadLoanProgress(); } 
    else{ window.location.href="index.html"; }
  });

  // Load profile and financials logic here...
  // Loan multi-step form logic here...
  // Loan submit, progress table, download CSV logic here...
});
</script>
</body>
</html>
